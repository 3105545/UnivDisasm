unit bmi2;

interface

uses uTestCase, UnivDisasm.Cnsts;

procedure Test_bmi2();

implementation

procedure Test_bmi2();
var
  TestCase: TTestCase;
begin
  TestCase := TTestCase.Create('bmi2');
  // -------------------------------------------------------------------
  TestCase.Start();
  TestCase.Arch := CPUX64;
  TestCase.TestCase(0, [$C4, $E3, $7B, $F0, $D8, $07], 'rorx   ebx,eax,0x7');
  TestCase.TestCase(1, [$C4, $E3, $7B, $F0, $19, $07], 'rorx   ebx,DWORD [rcx],0x7');
  TestCase.TestCase(2, [$C4, $43, $7B, $F0, $F9, $07], 'rorx   r15d,r9d,0x7');
  TestCase.TestCase(3, [$C4, $63, $7B, $F0, $39, $07], 'rorx   r15d,DWORD [rcx],0x7');
  TestCase.TestCase(4, [$C4, $E2, $63, $F6, $F0], 'mulx   esi,ebx,eax');
  TestCase.TestCase(5, [$C4, $E2, $63, $F6, $31], 'mulx   esi,ebx,DWORD [rcx]');
  TestCase.TestCase(6, [$C4, $42, $03, $F6, $D1], 'mulx   r10d,r15d,r9d');
  TestCase.TestCase(7, [$C4, $62, $03, $F6, $11], 'mulx   r10d,r15d,DWORD [rcx]');
  TestCase.TestCase(8, [$C4, $E2, $63, $F5, $F0], 'pdep   esi,ebx,eax');
  TestCase.TestCase(9, [$C4, $E2, $63, $F5, $31], 'pdep   esi,ebx,DWORD [rcx]');
  TestCase.TestCase(10, [$C4, $42, $03, $F5, $D1], 'pdep   r10d,r15d,r9d');
  TestCase.TestCase(11, [$C4, $62, $03, $F5, $11], 'pdep   r10d,r15d,DWORD [rcx]');
  TestCase.TestCase(12, [$C4, $E2, $62, $F5, $F0], 'pext   esi,ebx,eax');
  TestCase.TestCase(13, [$C4, $E2, $62, $F5, $31], 'pext   esi,ebx,DWORD [rcx]');
  TestCase.TestCase(14, [$C4, $42, $02, $F5, $D1], 'pext   r10d,r15d,r9d');
  TestCase.TestCase(15, [$C4, $62, $02, $F5, $11], 'pext   r10d,r15d,DWORD [rcx]');
  TestCase.TestCase(16, [$C4, $E2, $78, $F5, $F3], 'bzhi   esi,ebx,eax');
  TestCase.TestCase(17, [$C4, $E2, $60, $F5, $31], 'bzhi   esi,DWORD [rcx],ebx');
  TestCase.TestCase(18, [$C4, $42, $30, $F5, $D7], 'bzhi   r10d,r15d,r9d');
  TestCase.TestCase(19, [$C4, $62, $30, $F5, $11], 'bzhi   r10d,DWORD [rcx],r9d');
  TestCase.TestCase(20, [$C4, $E2, $7A, $F7, $F3], 'sarx   esi,ebx,eax');
  TestCase.TestCase(21, [$C4, $E2, $62, $F7, $31], 'sarx   esi,DWORD [rcx],ebx');
  TestCase.TestCase(22, [$C4, $42, $32, $F7, $D7], 'sarx   r10d,r15d,r9d');
  TestCase.TestCase(23, [$C4, $62, $32, $F7, $11], 'sarx   r10d,DWORD [rcx],r9d');
  TestCase.TestCase(24, [$C4, $E2, $79, $F7, $F3], 'shlx   esi,ebx,eax');
  TestCase.TestCase(25, [$C4, $E2, $61, $F7, $31], 'shlx   esi,DWORD [rcx],ebx');
  TestCase.TestCase(26, [$C4, $42, $31, $F7, $D7], 'shlx   r10d,r15d,r9d');
  TestCase.TestCase(27, [$C4, $62, $31, $F7, $11], 'shlx   r10d,DWORD [rcx],r9d');
  TestCase.TestCase(28, [$C4, $E2, $7B, $F7, $F3], 'shrx   esi,ebx,eax');
  TestCase.TestCase(29, [$C4, $E2, $63, $F7, $31], 'shrx   esi,DWORD [rcx],ebx');
  TestCase.TestCase(30, [$C4, $42, $33, $F7, $D7], 'shrx   r10d,r15d,r9d');
  TestCase.TestCase(31, [$C4, $62, $33, $F7, $11], 'shrx   r10d,DWORD [rcx],r9d');
  TestCase.TestCase(32, [$C4, $E3, $FB, $F0, $D8, $07], 'rorx   rbx,rax,0x7');
  TestCase.TestCase(33, [$C4, $E3, $FB, $F0, $19, $07], 'rorx   rbx,QWORD [rcx],0x7');
  TestCase.TestCase(34, [$C4, $43, $FB, $F0, $F9, $07], 'rorx   r15,r9,0x7');
  TestCase.TestCase(35, [$C4, $63, $FB, $F0, $39, $07], 'rorx   r15,QWORD [rcx],0x7');
  TestCase.TestCase(36, [$C4, $E2, $E3, $F6, $F0], 'mulx   rsi,rbx,rax');
  TestCase.TestCase(37, [$C4, $E2, $E3, $F6, $31], 'mulx   rsi,rbx,QWORD [rcx]');
  TestCase.TestCase(38, [$C4, $42, $83, $F6, $D1], 'mulx   r10,r15,r9');
  TestCase.TestCase(39, [$C4, $62, $83, $F6, $11], 'mulx   r10,r15,QWORD [rcx]');
  TestCase.TestCase(40, [$C4, $E2, $E3, $F5, $F0], 'pdep   rsi,rbx,rax');
  TestCase.TestCase(41, [$C4, $E2, $E3, $F5, $31], 'pdep   rsi,rbx,QWORD [rcx]');
  TestCase.TestCase(42, [$C4, $42, $83, $F5, $D1], 'pdep   r10,r15,r9');
  TestCase.TestCase(43, [$C4, $62, $83, $F5, $11], 'pdep   r10,r15,QWORD [rcx]');
  TestCase.TestCase(44, [$C4, $E2, $E2, $F5, $F0], 'pext   rsi,rbx,rax');
  TestCase.TestCase(45, [$C4, $E2, $E2, $F5, $31], 'pext   rsi,rbx,QWORD [rcx]');
  TestCase.TestCase(46, [$C4, $42, $82, $F5, $D1], 'pext   r10,r15,r9');
  TestCase.TestCase(47, [$C4, $62, $82, $F5, $11], 'pext   r10,r15,QWORD [rcx]');
  TestCase.TestCase(48, [$C4, $E2, $F8, $F5, $F3], 'bzhi   rsi,rbx,rax');
  TestCase.TestCase(49, [$C4, $E2, $F8, $F5, $31], 'bzhi   rsi,QWORD [rcx],rax');
  TestCase.TestCase(50, [$C4, $42, $B0, $F5, $D7], 'bzhi   r10,r15,r9');
  TestCase.TestCase(51, [$C4, $62, $B0, $F5, $11], 'bzhi   r10,QWORD [rcx],r9');
  TestCase.TestCase(52, [$C4, $E2, $FA, $F7, $F3], 'sarx   rsi,rbx,rax');
  TestCase.TestCase(53, [$C4, $E2, $FA, $F7, $31], 'sarx   rsi,QWORD [rcx],rax');
  TestCase.TestCase(54, [$C4, $42, $B2, $F7, $D7], 'sarx   r10,r15,r9');
  TestCase.TestCase(55, [$C4, $62, $B2, $F7, $11], 'sarx   r10,QWORD [rcx],r9');
  TestCase.TestCase(56, [$C4, $E2, $F9, $F7, $F3], 'shlx   rsi,rbx,rax');
  TestCase.TestCase(57, [$C4, $E2, $F9, $F7, $31], 'shlx   rsi,QWORD [rcx],rax');
  TestCase.TestCase(58, [$C4, $42, $B1, $F7, $D7], 'shlx   r10,r15,r9');
  TestCase.TestCase(59, [$C4, $62, $B1, $F7, $11], 'shlx   r10,QWORD [rcx],r9');
  TestCase.TestCase(60, [$C4, $E2, $FB, $F7, $F3], 'shrx   rsi,rbx,rax');
  TestCase.TestCase(61, [$C4, $E2, $FB, $F7, $31], 'shrx   rsi,QWORD [rcx],rax');
  TestCase.TestCase(62, [$C4, $42, $B3, $F7, $D7], 'shrx   r10,r15,r9');
  TestCase.TestCase(63, [$C4, $62, $B3, $F7, $11], 'shrx   r10,QWORD [rcx],r9');
  TestCase.TestCase(64, [$C4, $E3, $7B, $F0, $D8, $07], 'rorx   ebx,eax,0x7');
  TestCase.TestCase(65, [$C4, $E3, $7B, $F0, $19, $07], 'rorx   ebx,DWORD [rcx],0x7');
  TestCase.TestCase(66, [$C4, $43, $7B, $F0, $D1, $07], 'rorx   r10d,r9d,0x7');
  TestCase.TestCase(67, [$C4, $63, $7B, $F0, $11, $07], 'rorx   r10d,DWORD [rcx],0x7');
  TestCase.TestCase(68, [$C4, $E3, $7B, $F0, $19, $07], 'rorx   ebx,DWORD [rcx],0x7');
  TestCase.TestCase(69, [$C4, $E2, $63, $F6, $F0], 'mulx   esi,ebx,eax');
  TestCase.TestCase(70, [$C4, $E2, $63, $F6, $31], 'mulx   esi,ebx,DWORD [rcx]');
  TestCase.TestCase(71, [$C4, $42, $2B, $F6, $F9], 'mulx   r15d,r10d,r9d');
  TestCase.TestCase(72, [$C4, $62, $2B, $F6, $39], 'mulx   r15d,r10d,DWORD [rcx]');
  TestCase.TestCase(73, [$C4, $E2, $63, $F6, $31], 'mulx   esi,ebx,DWORD [rcx]');
  TestCase.TestCase(74, [$C4, $E2, $63, $F5, $F0], 'pdep   esi,ebx,eax');
  TestCase.TestCase(75, [$C4, $E2, $63, $F5, $31], 'pdep   esi,ebx,DWORD [rcx]');
  TestCase.TestCase(76, [$C4, $42, $2B, $F5, $F9], 'pdep   r15d,r10d,r9d');
  TestCase.TestCase(77, [$C4, $62, $2B, $F5, $39], 'pdep   r15d,r10d,DWORD [rcx]');
  TestCase.TestCase(78, [$C4, $E2, $63, $F5, $31], 'pdep   esi,ebx,DWORD [rcx]');
  TestCase.TestCase(79, [$C4, $E2, $62, $F5, $F0], 'pext   esi,ebx,eax');
  TestCase.TestCase(80, [$C4, $E2, $62, $F5, $31], 'pext   esi,ebx,DWORD [rcx]');
  TestCase.TestCase(81, [$C4, $42, $2A, $F5, $F9], 'pext   r15d,r10d,r9d');
  TestCase.TestCase(82, [$C4, $62, $2A, $F5, $39], 'pext   r15d,r10d,DWORD [rcx]');
  TestCase.TestCase(83, [$C4, $E2, $62, $F5, $31], 'pext   esi,ebx,DWORD [rcx]');
  TestCase.TestCase(84, [$C4, $E2, $78, $F5, $F3], 'bzhi   esi,ebx,eax');
  TestCase.TestCase(85, [$C4, $E2, $60, $F5, $31], 'bzhi   esi,DWORD [rcx],ebx');
  TestCase.TestCase(86, [$C4, $42, $30, $F5, $FA], 'bzhi   r15d,r10d,r9d');
  TestCase.TestCase(87, [$C4, $62, $30, $F5, $39], 'bzhi   r15d,DWORD [rcx],r9d');
  TestCase.TestCase(88, [$C4, $E2, $60, $F5, $31], 'bzhi   esi,DWORD [rcx],ebx');
  TestCase.TestCase(89, [$C4, $E2, $7A, $F7, $F3], 'sarx   esi,ebx,eax');
  TestCase.TestCase(90, [$C4, $E2, $62, $F7, $31], 'sarx   esi,DWORD [rcx],ebx');
  TestCase.TestCase(91, [$C4, $42, $32, $F7, $FA], 'sarx   r15d,r10d,r9d');
  TestCase.TestCase(92, [$C4, $62, $32, $F7, $39], 'sarx   r15d,DWORD [rcx],r9d');
  TestCase.TestCase(93, [$C4, $E2, $62, $F7, $31], 'sarx   esi,DWORD [rcx],ebx');
  TestCase.TestCase(94, [$C4, $E2, $79, $F7, $F3], 'shlx   esi,ebx,eax');
  TestCase.TestCase(95, [$C4, $E2, $61, $F7, $31], 'shlx   esi,DWORD [rcx],ebx');
  TestCase.TestCase(96, [$C4, $42, $31, $F7, $FA], 'shlx   r15d,r10d,r9d');
  TestCase.TestCase(97, [$C4, $62, $31, $F7, $39], 'shlx   r15d,DWORD [rcx],r9d');
  TestCase.TestCase(98, [$C4, $E2, $61, $F7, $31], 'shlx   esi,DWORD [rcx],ebx');
  TestCase.TestCase(99, [$C4, $E2, $7B, $F7, $F3], 'shrx   esi,ebx,eax');
  TestCase.TestCase(100, [$C4, $E2, $63, $F7, $31], 'shrx   esi,DWORD [rcx],ebx');
  TestCase.TestCase(101, [$C4, $42, $33, $F7, $FA], 'shrx   r15d,r10d,r9d');
  TestCase.TestCase(102, [$C4, $62, $33, $F7, $39], 'shrx   r15d,DWORD [rcx],r9d');
  TestCase.TestCase(103, [$C4, $E2, $63, $F7, $31], 'shrx   esi,DWORD [rcx],ebx');
  TestCase.TestCase(104, [$C4, $E3, $FB, $F0, $D8, $07], 'rorx   rbx,rax,0x7');
  TestCase.TestCase(105, [$C4, $E3, $FB, $F0, $19, $07], 'rorx   rbx,QWORD [rcx],0x7');
  TestCase.TestCase(106, [$C4, $43, $FB, $F0, $F9, $07], 'rorx   r15,r9,0x7');
  TestCase.TestCase(107, [$C4, $63, $FB, $F0, $39, $07], 'rorx   r15,QWORD [rcx],0x7');
  TestCase.TestCase(108, [$C4, $E3, $FB, $F0, $19, $07], 'rorx   rbx,QWORD [rcx],0x7');
  TestCase.TestCase(109, [$C4, $E2, $E3, $F6, $F0], 'mulx   rsi,rbx,rax');
  TestCase.TestCase(110, [$C4, $E2, $E3, $F6, $31], 'mulx   rsi,rbx,QWORD [rcx]');
  TestCase.TestCase(111, [$C4, $42, $83, $F6, $D1], 'mulx   r10,r15,r9');
  TestCase.TestCase(112, [$C4, $62, $83, $F6, $11], 'mulx   r10,r15,QWORD [rcx]');
  TestCase.TestCase(113, [$C4, $E2, $E3, $F6, $31], 'mulx   rsi,rbx,QWORD [rcx]');
  TestCase.TestCase(114, [$C4, $E2, $E3, $F5, $F0], 'pdep   rsi,rbx,rax');
  TestCase.TestCase(115, [$C4, $E2, $E3, $F5, $31], 'pdep   rsi,rbx,QWORD [rcx]');
  TestCase.TestCase(116, [$C4, $42, $83, $F5, $D1], 'pdep   r10,r15,r9');
  TestCase.TestCase(117, [$C4, $62, $83, $F5, $11], 'pdep   r10,r15,QWORD [rcx]');
  TestCase.TestCase(118, [$C4, $E2, $E3, $F5, $31], 'pdep   rsi,rbx,QWORD [rcx]');
  TestCase.TestCase(119, [$C4, $E2, $E2, $F5, $F0], 'pext   rsi,rbx,rax');
  TestCase.TestCase(120, [$C4, $E2, $E2, $F5, $31], 'pext   rsi,rbx,QWORD [rcx]');
  TestCase.TestCase(121, [$C4, $42, $82, $F5, $D1], 'pext   r10,r15,r9');
  TestCase.TestCase(122, [$C4, $62, $82, $F5, $11], 'pext   r10,r15,QWORD [rcx]');
  TestCase.TestCase(123, [$C4, $E2, $E2, $F5, $31], 'pext   rsi,rbx,QWORD [rcx]');
  TestCase.TestCase(124, [$C4, $E2, $F8, $F5, $F3], 'bzhi   rsi,rbx,rax');
  TestCase.TestCase(125, [$C4, $E2, $F8, $F5, $31], 'bzhi   rsi,QWORD [rcx],rax');
  TestCase.TestCase(126, [$C4, $42, $B0, $F5, $D7], 'bzhi   r10,r15,r9');
  TestCase.TestCase(127, [$C4, $62, $B0, $F5, $11], 'bzhi   r10,QWORD [rcx],r9');
  TestCase.TestCase(128, [$C4, $E2, $F8, $F5, $31], 'bzhi   rsi,QWORD [rcx],rax');
  TestCase.TestCase(129, [$C4, $E2, $FA, $F7, $F3], 'sarx   rsi,rbx,rax');
  TestCase.TestCase(130, [$C4, $E2, $FA, $F7, $31], 'sarx   rsi,QWORD [rcx],rax');
  TestCase.TestCase(131, [$C4, $42, $B2, $F7, $D7], 'sarx   r10,r15,r9');
  TestCase.TestCase(132, [$C4, $62, $B2, $F7, $11], 'sarx   r10,QWORD [rcx],r9');
  TestCase.TestCase(133, [$C4, $E2, $FA, $F7, $31], 'sarx   rsi,QWORD [rcx],rax');
  TestCase.TestCase(134, [$C4, $E2, $F9, $F7, $F3], 'shlx   rsi,rbx,rax');
  TestCase.TestCase(135, [$C4, $E2, $F9, $F7, $31], 'shlx   rsi,QWORD [rcx],rax');
  TestCase.TestCase(136, [$C4, $42, $B1, $F7, $D7], 'shlx   r10,r15,r9');
  TestCase.TestCase(137, [$C4, $62, $B1, $F7, $11], 'shlx   r10,QWORD [rcx],r9');
  TestCase.TestCase(138, [$C4, $E2, $F9, $F7, $31], 'shlx   rsi,QWORD [rcx],rax');
  TestCase.TestCase(139, [$C4, $E2, $FB, $F7, $F3], 'shrx   rsi,rbx,rax');
  TestCase.TestCase(140, [$C4, $E2, $FB, $F7, $31], 'shrx   rsi,QWORD [rcx],rax');
  TestCase.TestCase(141, [$C4, $42, $B3, $F7, $D7], 'shrx   r10,r15,r9');
  TestCase.TestCase(142, [$C4, $62, $B3, $F7, $11], 'shrx   r10,QWORD [rcx],r9');
  TestCase.TestCase(143, [$C4, $E2, $FB, $F7, $31], 'shrx   rsi,QWORD [rcx],rax');
  TestCase.Stop();
  TestCase.SaveToFile('log\bmi2.log');
  TestCase.Free;
end;

end.
